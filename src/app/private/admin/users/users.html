<div class="users-container">
  <!-- Message de chargement -->
  <div *ngIf="loading" class="loading-message">
    <i class="icon icon-spinner"></i> Chargement en cours...
  </div>

  <!-- Message d'erreur -->
  <div *ngIf="errorMessage && !loading" class="error-message">
    {{ errorMessage }}
    <button class="btn btn-outline" (click)="loadUsers()">
      <i class="icon icon-refresh"></i> Réessayer
    </button>
  </div>

  <!-- Datatable avec données -->
  <div *ngIf="!loading && !errorMessage && users.length > 0" class="table-wrapper">
    <app-datatable
      [data]="users"
      [columns]="userColumns"
      [actions]="userActions"
      [currentPage]="currentPage"
      [lastPage]="lastPage"
      [entriesPerPage]="itemsPerPage"
      [totalEntries]="totalEntries"
      [showSearch]="true"
      [showFilters]="false"
      [showExport]="true"
      [showPagination]="true"
      [showAddButton]="true"
      [serverSideSearch]="true"
      [entriesPerPageOptions]="[10, 25, 50, 100]"
      (addClicked)="onAddClicked()"
      (exportData)="onExportData($event)"
      (rowSelect)="onRowSelect($event)"
      (filterChange)="onFilterChange($event)"
      (pageChange)="onPageChange($event)">
    </app-datatable>
  </div>

  <!-- Message quand aucun résultat trouvé pour une recherche -->
  <div *ngIf="!loading && !errorMessage && users.length === 0 && noDataFound" class="no-search-results">
    <div class="no-results-icon">
      <i class="icon icon-search"></i>
    </div>
    <h3>Aucun résultat trouvé</h3>
    <p>Aucun utilisateur ne correspond à votre recherche "{{ filters.keyword }}"</p>
    <div class="no-results-actions">
      <button class="btn btn-outline" (click)="clearSearch()">
        <i class="icon icon-x"></i> Effacer la recherche
      </button>
      <button class="btn btn-primary" (click)="onAddClicked()">
        <i class="icon icon-plus"></i> Ajouter un utilisateur
      </button>
    </div>
  </div>

  <!-- Message si aucune donnée en général (première fois) -->
  <div *ngIf="!loading && !errorMessage && users.length === 0 && !noDataFound && (!filters.keyword || filters.keyword.trim() === '')" class="no-data-message">
    <div class="no-data-icon">
      <i class="icon icon-users"></i>
    </div>
    <h3>Aucun utilisateur</h3>
    <p>Il n'y a encore aucun utilisateur dans le système.</p>
    <button class="btn btn-primary" (click)="onAddClicked()">
      <i class="icon icon-plus"></i> Ajouter le premier utilisateur
    </button>
  </div>
</div>